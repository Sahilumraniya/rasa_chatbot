version: "3.1"

intents:
  - greet
  - goodbye
  - nlu_fallback
  # The 'inform' intent is GONE. This is correct.

entities:
  []

slots:
  user_name:
    type: text
    influence_conversation: true
    mappings:
      # --- THIS IS THE "POWERFUL" FIX ---
      - type: from_text
        conditions:
          # This mapping is ONLY active when the form is running
          - active_loop: name_form
        # THIS IS THE NEW LINE:
        # We tell the mapping to IGNORE the 'greet'
        # intent. This stops it from grabbing "hello"
        # as the name.
        not_intent:
          - greet
          - goodbye

forms:
  # This form's only job is to get the user's name
  name_form:
    required_slots:
      - user_name

responses:
  utter_greet_with_name:
    - text: "ðŸ‘‹ Hey {user_name}! How can I help you today?"

  utter_greet_no_name:
    - text: "ðŸ‘‹ Hello!"

  utter_ask_user_name:
    # This is the form's question
    - text: "What's your name?"

  utter_goodbye_with_name:
    - text: "Goodbye {user_name}! ðŸ‘‹"

  utter_goodbye_no_name:
    - text: "Goodbye friend! ðŸ‘‹"

  utter_ask_name_again:
    - text: "I'm sorry, I didn't catch that. What's your name?"

actions:
  # From your actions.py file
  - validate_name_form
  - action_vector_reasoner